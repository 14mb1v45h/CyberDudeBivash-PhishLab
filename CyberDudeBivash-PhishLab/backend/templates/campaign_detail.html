<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Campaign {{ campaign.id }} â€“ CyberDudeBivash PhishLab</title>
  <style>
    body { font-family: system-ui; background:#020617; color:#e5e7eb; margin:0; }
    header {
      background: linear-gradient(90deg,#0f172a,#1d4ed8);
      padding:1rem 2rem;
      box-shadow:0 1px 8px rgba(0,0,0,0.6);
    }
    header h1 { margin:0; font-size:1.3rem; }
    main { padding:2rem; }

    .stats-box { display:flex; gap:1rem; margin-top:1rem; flex-wrap:wrap; }
    .stat-card {
      background:#020617;
      border-radius:0.75rem;
      padding:0.9rem 1rem;
      width:180px;
      box-shadow:0 0 12px rgba(15,23,42,0.8);
    }
    .stat-label { font-size:0.75rem; text-transform:uppercase; color:#9ca3af; }
    .stat-value { font-size:1.3rem; margin-top:0.3rem; }

    table {
      width:100%; margin-top:1.5rem;
      border-collapse:collapse;
      background:#020617;
      border-radius:0.75rem;
      overflow:hidden;
      box-shadow:0 0 20px rgba(15,23,42,0.8);
    }
    th, td {
      padding:0.7rem 0.9rem;
      border-bottom:1px solid #1f2937;
      font-size:0.85rem;
    }
    th {
      background:#0b1120;
      color:#9ca3af;
      text-transform:uppercase;
      font-size:0.75rem;
      letter-spacing:0.05em;
    }
    tr:hover { background:#111827; }
    a { color:#38bdf8; text-decoration:none; }
    .actions { margin-top:1rem; }
    .btn {
      display:inline-block; padding:0.5rem 1rem;
      background:#1d4ed8; color:white;
      border-radius:0.5rem; margin-right:0.6rem;
      font-size:0.85rem; font-weight:500;
      text-decoration:none;
    }
  </style>
</head>
<body>
  <header>
    <h1>Campaign: {{ campaign.name }} (ID {{ campaign.id }})</h1>
    <div style="font-size:0.85rem; color:#cbd5f5;">
      Created: {{ campaign.created_at.strftime("%Y-%m-%d %H:%M") }}
    </div>
  </header>

  <main>

    <h2>Overview</h2>
    <div class="stats-box">
      <div class="stat-card">
        <div class="stat-label">Total Targets</div>
        <div class="stat-value">{{ total }}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Clicked</div>
        <div class="stat-value">{{ clicked }}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Submitted</div>
        <div class="stat-value">{{ submitted }}</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Reported</div>
        <div class="stat-value">{{ reported }}</div>
      </div>
    </div>

    <div class="actions">
      <a class="btn" href="/admin/campaigns/{{ campaign.id }}/upload">Upload CSV</a>
      <a class="btn" href="/admin/campaigns/{{ campaign.id }}/export.csv">Export CSV</a>
      <a class="btn" href="/admin/dashboard" style="background:#64748b;">Back</a>
    </div>

    <h2 style="margin-top:2rem;">Targets</h2>

    <table>
      <thead>
        <tr>
          <th>Email</th>
          <th>Name</th>
          <th>Status</th>
          <th>Clicked</th>
          <th>Submitted</th>
          <th>Training Link</th>
        </tr>
      </thead>
      <tbody>
        {for t in campaign.targets:
    target_rows.append({
        "id": t.id,
        "email": t.email,
        "name": t.name or "",
        "status": t.status,
        "clicked": t.first_clicked_at.strftime("%Y-%m-%d %H:%M") if t.first_clicked_at else "",
        "submitted": t.first_submitted_at.strftime("%Y-%m-%d %H:%M") if t.first_submitted_at else "",
        "link": f"/t/{t.token}",
    })
}
        <tr>
          <td>{{ t.email }}</td>
          <td>{{ t.name }}</td>
          <td>{{ t.status }}</td>
          <td>{{ t.clicked }}</td>
          <td>{{ t.submitted }}</td>
          <td>
  <a href="{{ t.link }}" target="_blank">{{ t.link }}</a><br>
  <a href="/admin/targets/{{ t.id }}" style="color:#38bdf8; font-size:0.75rem;">
    View Details
  </a>
</td>


        </tr>
        {% endfor %}
      </tbody>
    </table>

  </main>
</body>
</html>
